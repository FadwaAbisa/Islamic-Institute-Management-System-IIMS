# دليل استيراد بيانات الموظفين الإداريين

## نظرة عامة
هذا السكريبت يقوم باستيراد بيانات الموظفين الإداريين من ملف إكسل إلى قاعدة البيانات.

## المتطلبات
- Node.js مثبت على النظام
- قاعدة البيانات تعمل
- ملف `staff_db.xlsx` موجود في مجلد `data/`

## بنية ملف الإكسل المطلوبة

يجب أن يحتوي ملف الإكسل على الأعمدة التالية:

### الأعمدة المطلوبة (إجبارية):
- `fullName` - الاسم الكامل للموظف
- `nationalId` - الرقم الوطني/الجواز (يجب أن يكون فريد)
- `phone1` - رقم الهاتف الأول

### الأعمدة الاختيارية:
- `birthday` - تاريخ الميلاد
- `address` - العنوان
- `phone2` - رقم الهاتف الثاني
- `appointmentDate` - تاريخ التعيين
- `serviceStartDate` - تاريخ بدء الخدمة
- `academicQualification` - المؤهل العلمي
- `educationalInstitution` - المؤسسة التعليمية
- `majorSpecialization` - التخصص الرئيسي
- `graduationYear` - سنة التخرج
- `maritalStatus` - الحالة الاجتماعية (أعزب، متزوج، مطلق، أرمل)

## كيفية التشغيل

### الطريقة الأولى: استخدام TypeScript
```bash
npx ts-node import-staff.ts
```

### الطريقة الثانية: استخدام JavaScript
```bash
node import-staff.js
```

### الطريقة الثالثة: استخدام pnpm
```bash
pnpm tsx import-staff.ts
```

## مثال على بيانات الإكسل

| fullName | nationalId | phone1 | birthday | address | maritalStatus |
|----------|------------|---------|----------|---------|---------------|
| أحمد محمد علي | 1234567890 | 07701234567 | 1990-05-15 | بغداد، الكرخ | متزوج |
| فاطمة حسن | 0987654321 | 07809876543 | 1985-12-20 | بغداد، الرصافة | أعزب |

## ملاحظات مهمة

1. **البيانات المطلوبة**: تأكد من وجود الاسم الكامل والرقم الوطني ورقم الهاتف في كل صف
2. **فريدية الرقم الوطني**: لا يمكن تكرار الرقم الوطني لأكثر من موظف
3. **تنسيق التواريخ**: استخدم التنسيق YYYY-MM-DD للتواريخ
4. **الحالة الاجتماعية**: يمكن استخدام العربية أو الإنجليزية

## معالجة الأخطاء

السكريبت يتعامل مع الأخطاء التالية:
- البيانات المفقودة
- تكرار الرقم الوطني
- أخطاء في تنسيق التواريخ
- أخطاء في الاتصال بقاعدة البيانات

## النتائج

بعد التشغيل الناجح، سترى:
- عدد الموظفين المستوردين بنجاح
- عدد الموظفين الذين فشل استيرادهم
- تفاصيل كل عملية استيراد
- ملخص نهائي للعملية

## استكشاف الأخطاء

إذا واجهت مشاكل:

1. **تأكد من وجود الملف**: `data/staff_db.xlsx`
2. **تأكد من تشغيل قاعدة البيانات**
3. **تحقق من تنسيق البيانات** في ملف الإكسل
4. **راجع رسائل الخطأ** في وحدة التحكم

## دعم إضافي

للمساعدة الإضافية، راجع:
- ملف `schema.prisma` لفهم بنية قاعدة البيانات
- ملف `import-students.ts` كمثال مشابه
- وثائق Prisma الرسمية
