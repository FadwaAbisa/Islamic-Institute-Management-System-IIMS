# دليل استيراد بيانات الموظفين الإداريين - المعهد الإسلامي

## 🎯 نظرة عامة

هذا النظام يتيح لك استيراد بيانات الموظفين الإداريين من ملف إكسل إلى قاعدة البيانات الخاصة بالمعهد الإسلامي.

## 📋 المتطلبات

- ✅ Node.js مثبت على النظام
- ✅ قاعدة البيانات تعمل (PostgreSQL)
- ✅ ملف `staff_db.xlsx` موجود في مجلد `data/`
- ✅ جميع المكتبات مثبتة (`pnpm install`)

## 🚀 البدء السريع

### 1. فحص ملف الإكسل
```bash
pnpm check-staff-excel
```

### 2. استيراد البيانات
```bash
pnpm import-staff
```

## 📁 الملفات المطلوبة

### ملف الإكسل: `data/staff_db.xlsx`

يجب أن يحتوي على الأعمدة التالية:

| العمود | الوصف | مطلوب | مثال |
|---------|---------|---------|---------|
| `fullName` | الاسم الكامل | ✅ | أحمد محمد علي |
| `nationalId` | الرقم الوطني | ✅ | 1234567890 |
| `phone1` | رقم الهاتف | ✅ | 07701234567 |
| `birthday` | تاريخ الميلاد | ❌ | 1990-05-15 |
| `address` | العنوان | ❌ | بغداد، الكرخ |
| `phone2` | هاتف ثانوي | ❌ | 07801234567 |
| `appointmentDate` | تاريخ التعيين | ❌ | 2020-09-01 |
| `serviceStartDate` | تاريخ بدء الخدمة | ❌ | 2020-09-01 |
| `academicQualification` | المؤهل العلمي | ❌ | بكالوريوس |
| `educationalInstitution` | المؤسسة التعليمية | ❌ | جامعة بغداد |
| `majorSpecialization` | التخصص | ❌ | علوم حاسبات |
| `graduationYear` | سنة التخرج | ❌ | 2015 |
| `maritalStatus` | الحالة الاجتماعية | ❌ | متزوج |

## 🔧 الأوامر المتاحة

### فحص ملف الإكسل
```bash
# فحص محتوى الملف والبيانات
pnpm check-staff-excel

# أو مباشرة
node check-staff-excel.js
```

### استيراد البيانات
```bash
# استيراد الموظفين
pnpm import-staff

# أو مباشرة
node import-staff.js

# أو باستخدام TypeScript
npx ts-node import-staff.ts
```

## 📊 مثال على البيانات

```csv
fullName,nationalId,phone1,birthday,address,maritalStatus
أحمد محمد علي,1234567890,07701234567,1990-05-15,بغداد الكرخ,متزوج
فاطمة حسن,0987654321,07809876543,1985-12-20,بغداد الرصافة,أعزب
علي محمود,1122334455,07901112233,1988-08-10,البصرة,متزوج
```

## ⚠️ ملاحظات مهمة

### البيانات المطلوبة
- **الاسم الكامل**: لا يمكن أن يكون فارغاً
- **الرقم الوطني**: يجب أن يكون فريد لكل موظف
- **رقم الهاتف**: مطلوب للتواصل

### القيود
- لا يمكن تكرار الرقم الوطني
- التواريخ يجب أن تكون بالتنسيق YYYY-MM-DD
- الحالة الاجتماعية يمكن أن تكون بالعربية أو الإنجليزية

## 🛠️ استكشاف الأخطاء

### مشكلة: الملف غير موجود
```
❌ خطأ في قراءة الملف: ENOENT: no such file or directory
📁 تأكد من وجود مجلد 'data' وملف 'staff_db.xlsx' بداخله
```

**الحل**: تأكد من وجود الملف في المسار الصحيح

### مشكلة: بيانات مفقودة
```
⚠️ تخطي الصف 1: بيانات مفقودة (الاسم: , الهوية: , الهاتف: )
```

**الحل**: تأكد من ملء الأعمدة المطلوبة

### مشكلة: رقم وطني مكرر
```
❌ خطأ في الصف 2: رقم الهوية 1234567890 موجود مسبقاً
```

**الحل**: تأكد من عدم تكرار الأرقام الوطنية

### مشكلة: خطأ في قاعدة البيانات
```
❌ خطأ في الاتصال بقاعدة البيانات
```

**الحل**: تأكد من تشغيل قاعدة البيانات وملف `.env`

## 📈 مراقبة العملية

عند تشغيل الاستيراد، سترى:

```
🚀 بدء عملية استيراد بيانات الموظفين الإداريين...
📊 تم العثور على 25 موظف في الملف
✅ [1/25] تم إنشاء الموظف: أحمد محمد علي
✅ [2/25] تم إنشاء الموظف: فاطمة حسن
...

📈 ملخص العملية:
✅ نجح: 25 موظف
❌ فشل: 0 موظف
📊 إجمالي: 25 سجل
🔌 تم قطع الاتصال مع قاعدة البيانات
```

## 🔄 إعادة تشغيل

إذا أردت إعادة تشغيل الاستيراد:

1. **احذف البيانات الموجودة** من قاعدة البيانات
2. **أعد تشغيل السكريبت**
3. **أو استخدم Prisma Studio** لإدارة البيانات

## 📚 ملفات إضافية

- `STAFF-EXCEL-TEMPLATE.md` - نموذج مفصل لملف الإكسل
- `STAFF-IMPORT-README.md` - دليل شامل للاستيراد
- `import-staff.ts` - سكريبت TypeScript
- `import-staff.js` - سكريبت JavaScript
- `check-staff-excel.js` - فحص ملف الإكسل

## 🆘 الدعم

إذا واجهت مشاكل:

1. **راجع رسائل الخطأ** في وحدة التحكم
2. **تحقق من تنسيق البيانات** في ملف الإكسل
3. **تأكد من تشغيل قاعدة البيانات**
4. **راجع ملف `.env`** لإعدادات قاعدة البيانات

## 🎉 النجاح!

بعد الاستيراد الناجح، ستتمكن من:
- عرض الموظفين في النظام
- إدارة بياناتهم
- تتبع حضورهم
- إدارة صلاحياتهم

---

**تم إنشاء هذا النظام بواسطة فريق المعهد الإسلامي** 🕌
