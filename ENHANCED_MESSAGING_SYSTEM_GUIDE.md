# 📱 دليل نظام الرسائل المحسن

## 🎯 القواعد الجديدة للدردشة

تم تطوير نظام الرسائل ليدعم التواصل المنظم بين الأدوار المختلفة:

### 📋 قواعد التواصل

| الدور | يستطيع التواصل مع |
|-------|------------------|
| **الطالب** | المعلمين فقط |
| **المعلم** | الطلاب + الموظفين الإداريين |
| **الموظف الإداري** | المعلمين + مدير النظام |
| **مدير النظام** | الموظفين الإداريين فقط |

### 🔗 مسار التواصل الهرمي

```
الطالب ↔ المعلم ↔ الموظف الإداري ↔ مدير النظام
```

## 🚀 كيفية تجربة النظام

### 1. الوصول للنظام التجريبي

اذهب إلى: `/list/messages/working`

### 2. تجربة الأدوار المختلفة

#### 🎓 كطالب:
- ستجد قائمة بالمعلمين فقط للتواصل معهم
- يمكنك رؤية المحادثات السابقة مع المعلمين
- النقر على "رسالة جديدة" سيظهر المعلمين المتاحين

#### 👨‍🏫 كمعلم:
- ستجد قوائم منفصلة للطلاب والموظفين الإداريين
- يمكنك التواصل مع كلا المجموعتين
- ستظهر لك أنواع مختلفة من المحادثات

#### 👔 كموظف إداري:
- ستجد قوائم للمعلمين ومدير النظام
- يمكنك التنسيق بين المعلمين والإدارة العليا
- ستظهر محادثات تنسيقية ومهنية

#### 🏛️ كمدير النظام:
- ستجد قائمة بالموظفين الإداريين فقط
- يمكنك الإشراف ومتابعة التقارير
- محادثات على مستوى إداري عالي

## 🛠️ كيفية تغيير الدور للاختبار

### الطريقة 1: من خلال localStorage
```javascript
// في Console المتصفح (F12)
localStorage.setItem("userRole", "student");   // للطالب
localStorage.setItem("userRole", "teacher");   // للمعلم  
localStorage.setItem("userRole", "staff");     // للموظف الإداري
localStorage.setItem("userRole", "admin");     // لمدير النظام

// ثم أعد تحميل الصفحة
window.location.reload();
```

### الطريقة 2: من خلال صفحة Debug
اذهب إلى: `/debug-role` لتغيير الدور

## 🎨 المميزات المطورة

### ✅ تم التطوير:

1. **منطق الأدوار الذكي**
   - كل دور يرى فقط من يُسمح له بالتواصل معهم
   - رسائل ديناميكية تتغير حسب الدور

2. **واجهة مستخدم محسنة**
   - عرض وصف مخصص لكل دور
   - رسائل تجريبية واقعية لكل سيناريو

3. **نظام محادثات متقدم**
   - محادثات مختلفة لكل مجموعة أدوار
   - رسائل سياقية ومناسبة لكل دور

4. **API محسن**
   - نقاط API منفصلة للبيانات التجريبية
   - دعم كامل لجميع الأدوار

## 📱 صفحات النظام

### الصفحات المتاحة:
- `/list/messages/working` - القائمة الرئيسية (تجريبي)
- `/list/messages/working/[id]` - صفحة الدردشة (تجريبي)
- `/list/messages` - النسخة الفعلية (تحتاج قاعدة بيانات)
- `/list/messages/[id]` - الدردشة الفعلية (تحتاج قاعدة بيانات)

## 🔧 الخطوات التالية

### لتفعيل النظام الفعلي:

1. **تشغيل Migration لقاعدة البيانات**
```bash
npx prisma generate
npx prisma migrate dev --name add-messages-system
```

2. **إعادة تشغيل الخادم**
```bash
npm run dev
# أو
pnpm run dev
```

3. **الانتقال للنسخة الفعلية**
- استخدم `/list/messages` بدلاً من `/list/messages/working`

## 🎯 سيناريوهات الاختبار

### السيناريو 1: طالب يسأل معلم
1. غيّر الدور إلى "student"
2. اذهب لـ `/list/messages/working`
3. انقر على محادثة مع معلم
4. جرب إرسال رسالة

### السيناريو 2: معلم ينسق مع موظف إداري
1. غيّر الدور إلى "teacher"
2. اذهب لـ `/list/messages/working`
3. انقر على محادثة مع موظف إداري
4. شاهد نوع المحادثات المهنية

### السيناريو 3: موظف إداري يتواصل مع مدير النظام
1. غيّر الدور إلى "staff"
2. اذهب لـ `/list/messages/working`
3. انقر على محادثة مع مدير النظام
4. شاهد التقارير والمتابعات الإدارية

### السيناريو 4: مدير النظام يراجع التقارير
1. غيّر الدور إلى "admin"
2. اذهب لـ `/list/messages/working`
3. انقر على محادثة مع موظف إداري
4. شاهد التفاعل الإداري العالي

## 🚨 ملاحظات مهمة

- النظام حالياً في وضع تجريبي مع بيانات وهمية
- جميع الرسائل والمحادثات تجريبية
- النظام الفعلي يحتاج تفعيل قاعدة البيانات
- الواجهة مصممة لتكون جاهزة للاستخدام الفعلي

## 🎉 النتيجة

تم إنشاء نظام رسائل متكامل يدعم:
- ✅ التواصل الهرمي بين الأدوار
- ✅ واجهة مستخدم عصرية وسلسة
- ✅ نظام محادثات متقدم
- ✅ تجربة مستخدم محسنة لكل دور
- ✅ قابلية التوسع والتطوير

**النظام جاهز للاختبار والاستخدام! 🚀**
