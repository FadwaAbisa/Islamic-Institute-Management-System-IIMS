# 🎯 نظام استيراد بيانات الموظفين الإداريين - المعهد الإسلامي

## ✅ تم بنجاح!

تم إنشاء نظام كامل لاستيراد بيانات الموظفين الإداريين من ملف إكسل إلى قاعدة البيانات.

## 📊 النتائج

- **إجمالي الموظفين في الملف**: 23
- **تم استيرادهم بنجاح**: 20 موظف ✅
- **فشل في الاستيراد**: 3 موظف ❌ (بسبب بيانات مفقودة)

## 🚀 كيفية الاستخدام

### 1. فحص ملف الإكسل
```bash
pnpm check-staff-excel
```

### 2. استيراد البيانات
```bash
pnpm import-staff
```

## 📁 الملفات المطلوبة

### ملف الإكسل: `data/staff_db.xlsx`

يجب أن يحتوي على الأعمدة التالية:

| العمود | الوصف | مطلوب | مثال |
|---------|---------|---------|---------|
| `الاسم الكامل (مطلوب)` | الاسم الكامل | ✅ | اسراء خالد سالم بن عطية |
| `الرقم الوطني/الجواز (مطلوب)` | الرقم الوطني | ✅ | 220000141156 |
| `هاتف أول (مطلوب)` | رقم الهاتف | ✅ | 0914117642 |
| `تاريخ الميلاد (YYYY-MM-DD)` | تاريخ الميلاد | ❌ | 28-04-2000 |
| `عنوان السكن` | العنوان | ❌ | غوط الشعال |
| `الحالة الاجتماعية` | الحالة الاجتماعية | ❌ | متزوجة |
| `تاريخ التعيين (YYYY-MM-DD)` | تاريخ التعيين | ❌ | 28-12-2023 |
| `تاريخ بداية الخدمة (YYYY-MM-DD)` | تاريخ بدء الخدمة | ❌ | 19-5-2024 |
| `المؤهل العلمي` | المؤهل العلمي | ❌ | دبلوم متوسط |
| `المؤسسة التعليمية` | المؤسسة التعليمية | ❌ | الاعتصام للتعليم التشاركي |
| `التخصص الرئيسي` | التخصص | ❌ | حاسوب |
| `سنة التخرج` | سنة التخرج | ❌ | 2022 |

## 🔧 الأوامر المتاحة

### فحص ملف الإكسل
```bash
# فحص محتوى الملف والبيانات
pnpm check-staff-excel

# أو مباشرة
node check-staff-excel.js
```

### استيراد البيانات
```bash
# استيراد الموظفين
pnpm import-staff

# أو مباشرة
node import-staff.js

# أو باستخدام TypeScript
npx ts-node import-staff.ts
```

## 📊 مثال على البيانات المستوردة

```
✅ [1/23] تم إنشاء الموظف: اسراء خالد سالم بن عطية
✅ [2/23] تم إنشاء الموظف: الخامسة سعيد خليفة الجالى
✅ [3/23] تم إنشاء الموظف: انتصار عياد محمد إبراهيم
✅ [4/23] تم إنشاء الموظف: أروى أبو القاسم يعقوب خليفة
✅ [5/23] تم إنشاء الموظف: أسماء محمد ميلاد المحمودي
...
```

## ⚠️ ملاحظات مهمة

### البيانات المطلوبة
- **الاسم الكامل**: لا يمكن أن يكون فارغاً
- **الرقم الوطني**: يجب أن يكون فريد لكل موظف
- **رقم الهاتف**: مطلوب للتواصل

### القيود
- لا يمكن تكرار الرقم الوطني
- التواريخ يتم معالجتها تلقائياً (DD-MM-YYYY, DD/MM/YYYY, أرقام Excel)
- الحالة الاجتماعية يمكن أن تكون بالعربية أو الإنجليزية

## 🛠️ معالجة التواريخ

النظام يتعامل مع عدة تنسيقات للتواريخ:

1. **DD-MM-YYYY**: 28-04-2000
2. **DD/MM/YYYY**: 15/12/1987
3. **أرقام Excel**: 45300 (يتم تحويلها تلقائياً)
4. **YYYY-MM-DD**: 2000-04-28

## 🛠️ استكشاف الأخطاء

### مشكلة: بيانات مفقودة
```
⚠️ تخطي الصف 9: بيانات مفقودة (الاسم: حميدة مصطفى علي الشيخ, الهوية: 219760547902, الهاتف: undefined)
```

**الحل**: تأكد من ملء عمود الهاتف في ملف الإكسل

### مشكلة: رقم وطني مكرر
```
❌ خطأ في الصف 2: رقم الهوية 1234567890 موجود مسبقاً
```

**الحل**: تأكد من عدم تكرار الأرقام الوطنية

## 📈 مراقبة العملية

عند تشغيل الاستيراد، سترى:

```
🚀 بدء عملية استيراد بيانات الموظفين الإداريين...
📊 تم العثور على 23 موظف في الملف
✅ [1/23] تم إنشاء الموظف: اسراء خالد سالم بن عطية
✅ [2/23] تم إنشاء الموظف: الخامسة سعيد خليفة الجالى
...

📈 ملخص العملية:
✅ نجح: 20 موظف
❌ فشل: 3 موظف
📊 إجمالي: 23 سجل
🔌 تم قطع الاتصال مع قاعدة البيانات
```

## 🔄 إعادة تشغيل

إذا أردت إعادة تشغيل الاستيراد:

1. **احذف البيانات الموجودة** من قاعدة البيانات
2. **أعد تشغيل السكريبت**
3. **أو استخدم Prisma Studio** لإدارة البيانات

## 📚 الملفات المتاحة

- `import-staff.ts` - سكريبت TypeScript
- `import-staff.js` - سكريبت JavaScript
- `check-staff-excel.js` - فحص ملف الإكسل
- `STAFF-EXCEL-TEMPLATE.md` - نموذج مفصل لملف الإكسل
- `STAFF-IMPORT-README.md` - دليل شامل للاستيراد

## 🎉 النجاح!

بعد الاستيراد الناجح، ستتمكن من:
- عرض الموظفين في النظام
- إدارة بياناتهم
- تتبع حضورهم
- إدارة صلاحياتهم

## 🆘 الدعم

إذا واجهت مشاكل:

1. **راجع رسائل الخطأ** في وحدة التحكم
2. **تحقق من تنسيق البيانات** في ملف الإكسل
3. **تأكد من تشغيل قاعدة البيانات**
4. **راجع ملف `.env`** لإعدادات قاعدة البيانات

---

**تم إنشاء هذا النظام بواسطة فريق المعهد الإسلامي** 🕌

**تاريخ الإنشاء**: ديسمبر 2024  
**الحالة**: يعمل بنجاح ✅
